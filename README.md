# twitter_notifier
フォローとリムーブとブロックを検出して自分のアカウントにDMを送信する
ブロックは検出できない場合がある(後述)

notifierという名前だがこのプログラム自体には通知する機能はない(DMを自分に送信)
## 検出の仕組み
初回起動時はフォロワーと相互フォローの一覧を保存する
以降は前回起動時と起動時のフォロワーと相互フォローの一覧を比較してフォローとリムーブ、ブロックを検出して取得したフォロワーと相互フォローの一覧を保存する
### フォロー
```
(起動時のフォロワー - 前回起動時のフォロワー) & 起動時のフォロワー
```
### リムーブ
以下から起動時のフォロワーに含まれないユーザを除外
```
(前回起動時のフォロワー - 起動時のフォロワー)
```
### ブロック
今までお互いにフォローし合っていたが、お互いにフォローが外れた状態になるとブロックを検出する。
ただし、フォロワーだったがブロックされた場合やフォローしていないし、フォローされていない状態からブロックされた場合は検出することができない
```
(前回までの相互フォロー - 起動時の相互フォロー)
```
## 設定
Twitterのコンシューマーキーとコンシューマーシークレットは用意しておく
環境変数TWITTER_CONSUMER_KEYにコンシューマーキー、CONSUMER_SECRETにコンシューマーシークレットを設定する
### gemのインストール
bundlerはインストールしておく

```
bundle install --path vendor/bundle
```
### 起動
初回起動時は認証が必要
```
ruby twitter_notifier.rb
```
cronなどを用いて定期的に実行する